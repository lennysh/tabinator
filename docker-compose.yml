version: '3.8'
services:
  web:
    # Build the image from the Dockerfile in the current directory
    build: .
    container_name: tabinator
    ports:
      - "8080:8080" # The Node.js server runs on port 8080
    volumes:
      # Mount the 'app' directory for static files
      - ./app:/usr/src/app/app
      # Mount the 'data' directory to persist SQLite database
      - ./data:/usr/src/app/data
    restart: unless-stopped
    security_opt:
      - no-new-privileges:true
    environment:
      # Set a secure session secret in production!
      - SESSION_SECRET=${SESSION_SECRET:-change-this-secret-in-production}
      - NODE_ENV=production
